<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <title>Flip 7 - Online Card Game</title>
    
    <!-- HIJACK DESKTOP LAYOUT FOR MOBILE - FORCE TRANSFORM -->
    <style>
    /* FORCE MOBILE LAYOUT BY HIJACKING DESKTOP ELEMENTS */
    
    /* STEP 1: Force body to mobile structure */
    body {
        margin: 0 !important;
        padding: 0 !important;
        width: 100vw !important;
        height: 100vh !important;
        overflow: hidden !important;
        background: linear-gradient(135deg, #4a90a4 0%, #357a8a 50%, #2c6b7a 100%) !important;
    }
    
    /* STEP 2: Transform game-container into mobile layout */
    .game-container {
        display: flex !important;
        flex-direction: column !important;
        width: 100vw !important;
        height: 100vh !important;
        padding: 8px !important;
        gap: 8px !important;
        position: fixed !important;
        top: 0 !important;
        left: 0 !important;
        box-sizing: border-box !important;
    }
    
    /* STEP 3: Hide desktop layout completely */
    .draw-pile-column, .controls-panel, .desktop-info, .mobile-game-board, .mobile-status-banner, .mobile-info-panel {
        display: none !important;
    }
    
    /* STEP 3.5: Hide scoreboard text specifically */
    .scoreboard, #scoreboard-content, .desktop-info.scoreboard {
        display: none !important;
        visibility: hidden !important;
        opacity: 0 !important;
    }
    
    /* STEP 4: Transform desktop game-area into mobile layout */
    .game-area {
        display: flex !important;
        flex-direction: column !important;
        flex: 1 !important;
        gap: 8px !important;
        width: 100% !important;
        height: 100% !important;
        padding: 0 !important;
        margin: 0 !important;
        grid-template-rows: none !important;
    }
    
    /* STEP 5: Transform desktop players-grid into mobile stack */
    .players-grid {
        display: flex !important;
        flex-direction: column !important;
        flex: 1 !important;
        gap: 6px !important;
        width: 100% !important;
        padding: 0 !important;
        margin: 0 !important;
        overflow: hidden !important;
    }
    
    /* STEP 6: Transform individual player areas for mobile */
    .player-area {
        display: flex !important;
        flex-direction: column !important;
        min-height: 80px !important;
        padding: 8px !important;
        margin: 2px 0 !important;
        border-radius: 8px !important;
        border: 2px solid rgba(255,255,255,0.3) !important;
    }
    
    
    /* STEP 7: Fix action buttons visibility at bottom - Glass-morphism style */
    .action-buttons {
        position: fixed !important;
        bottom: 20px !important;
        left: 10px !important;
        right: 10px !important;
        display: flex !important;
        justify-content: space-around !important;
        gap: 20px !important;
        padding: 20px !important;
        background: linear-gradient(135deg, 
            rgba(255, 255, 255, 0.15) 0%, 
            rgba(255, 255, 255, 0.1) 100%) !important;
        backdrop-filter: blur(15px) !important;
        -webkit-backdrop-filter: blur(15px) !important;
        border: 1px solid rgba(255, 255, 255, 0.2) !important;
        border-radius: 20px !important;
        z-index: 9999 !important;
        box-shadow: 0 8px 32px rgba(31, 38, 135, 0.37) !important;
    }
    
    /* Style the buttons - Elegant glass-morphism design */
    .action-buttons .btn {
        flex: 1 !important;
        padding: 18px 25px !important;
        font-size: 18px !important;
        font-weight: 600 !important;
        border: 1px solid rgba(255, 255, 255, 0.3) !important;
        border-radius: 16px !important;
        color: white !important;
        cursor: pointer !important;
        min-height: 55px !important;
        text-transform: uppercase !important;
        letter-spacing: 1.5px !important;
        position: relative !important;
        overflow: hidden !important;
        transition: all 0.3s ease !important;
        text-shadow: 0 2px 4px rgba(0, 0, 0, 0.2) !important;
    }
    
    /* Hit button - Teal to emerald gradient */
    .action-buttons .btn.primary {
        background: linear-gradient(135deg, 
            rgba(20, 184, 166, 0.8) 0%, 
            rgba(16, 185, 129, 0.8) 100%) !important;
        box-shadow: 0 4px 15px rgba(16, 185, 129, 0.3),
                    inset 0 1px 0 rgba(255, 255, 255, 0.3) !important;
    }
    
    /* Stay button - Deep blue to purple gradient */
    .action-buttons .btn.secondary {
        background: linear-gradient(135deg, 
            rgba(59, 130, 246, 0.8) 0%, 
            rgba(147, 51, 234, 0.8) 100%) !important;
        box-shadow: 0 4px 15px rgba(147, 51, 234, 0.3),
                    inset 0 1px 0 rgba(255, 255, 255, 0.3) !important;
    }
    
    /* Button Interactive States */
    .action-buttons .btn:hover:not(:disabled) {
        transform: translateY(-2px) scale(1.02) !important;
        box-shadow: 0 6px 20px rgba(16, 185, 129, 0.4) !important;
        border-color: rgba(255, 255, 255, 0.5) !important;
    }
    
    .action-buttons .btn.secondary:hover:not(:disabled) {
        box-shadow: 0 6px 20px rgba(147, 51, 234, 0.4) !important;
    }
    
    .action-buttons .btn:active:not(:disabled) {
        transform: translateY(0) scale(0.98) !important;
        box-shadow: 0 2px 8px rgba(16, 185, 129, 0.3),
                    inset 0 2px 4px rgba(0, 0, 0, 0.2) !important;
    }
    
    .action-buttons .btn.secondary:active:not(:disabled) {
        box-shadow: 0 2px 8px rgba(147, 51, 234, 0.3),
                    inset 0 2px 4px rgba(0, 0, 0, 0.2) !important;
    }
    
    /* Disabled state */
    .action-buttons .btn:disabled {
        opacity: 0.4 !important;
        filter: grayscale(50%) !important;
        cursor: not-allowed !important;
        transform: none !important;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1) !important;
    }
    
    /* Subtle glow animation for enabled buttons */
    .action-buttons .btn:not(:disabled) {
        animation: subtleGlow 3s ease-in-out infinite alternate !important;
    }
    
    @keyframes subtleGlow {
        0% { 
            box-shadow: 0 4px 15px rgba(16, 185, 129, 0.3),
                        inset 0 1px 0 rgba(255, 255, 255, 0.3);
        }
        100% { 
            box-shadow: 0 4px 18px rgba(16, 185, 129, 0.4),
                        inset 0 1px 0 rgba(255, 255, 255, 0.4);
        }
    }
    
    .action-buttons .btn.secondary:not(:disabled) {
        animation: subtleGlowPurple 3s ease-in-out infinite alternate !important;
    }
    
    @keyframes subtleGlowPurple {
        0% { 
            box-shadow: 0 4px 15px rgba(147, 51, 234, 0.3),
                        inset 0 1px 0 rgba(255, 255, 255, 0.3);
        }
        100% { 
            box-shadow: 0 4px 18px rgba(147, 51, 234, 0.4),
                        inset 0 1px 0 rgba(255, 255, 255, 0.4);
        }
    }
    
    /* STEP 8: Show total scores but hide round scores */
    .round-score,
    .mobile-round-score,
    .round-value {
        display: none !important; /* Hide round scores */
        visibility: hidden !important;
        opacity: 0 !important;
        height: 0 !important;
        overflow: hidden !important;
    }
    
    /* Show total scores */
    .player-stats,
    .total-score,
    .score-value {
        display: block !important;
        visibility: visible !important;
        opacity: 1 !important;
        height: auto !important;
        overflow: visible !important;
    }
    
    /* 2x2 CSS Grid Layout for Player Areas */
    .player-area {
        display: grid !important;
        grid-template-columns: 1fr 1fr !important; /* Two equal columns */
        grid-template-rows: auto auto !important; /* Two rows, auto height */
        gap: 4px !important;
        position: relative !important;
        overflow: visible !important;
        padding: 6px !important;
    }
    
    /* Top Left: Player Name */
    .player-area h3 {
        grid-column: 1 !important;
        grid-row: 1 !important;
        font-size: 0.7em !important;
        margin: 0 !important;
        padding: 2px 4px !important;
        text-align: left !important;
        font-weight: bold !important;
        background: rgba(0, 0, 0, 0.5) !important;
        color: white !important;
        border-radius: 3px !important;
    }
    
    /* Top Right: Total Score */
    .player-area .player-stats {
        grid-column: 2 !important;
        grid-row: 1 !important;
        text-align: right !important;
        font-size: 0.6em !important;
        margin: 0 !important;
        padding: 2px 4px !important;
        background: rgba(0, 0, 0, 0.3) !important;
        color: white !important;
        border-radius: 3px !important;
    }
    
    /* Bottom Left: Number Cards */
    .player-area .number-cards {
        grid-column: 1 !important;
        grid-row: 2 !important;
        min-height: 18px !important;
        margin: 0 !important;
        background: rgba(255, 255, 255, 0.1) !important;
        border-radius: 3px !important;
        padding: 2px !important;
    }
    
    /* Right Middle: Modifier Cards - Determines right column height */
    .player-area .modifier-cards {
        grid-column: 2 !important;
        grid-row: 2 !important;
        min-height: 15px !important;
        margin: 0 !important;
        background: rgba(255, 255, 255, 0.1) !important;
        border-radius: 3px !important;
        padding: 2px !important;
    }
    
    /* Bottom Right: Unique Counter - Positioned below modifier cards in right column */
    .player-area .unique-counter {
        position: absolute !important; /* Overlay, doesn't affect grid height */
        top: auto !important;
        bottom: 2px !important; /* Position at bottom of container */
        right: 2px !important; /* Right side of container */
        width: calc(50% - 8px) !important; /* Match right column width */
        margin: 0 !important;
        text-align: center !important;
        font-size: 0.6em !important;
        padding: 3px 4px !important;
        background: rgba(0, 0, 0, 0.8) !important;
        border-radius: 4px !important;
        min-height: 12px !important;
        box-sizing: border-box !important;
    }
    </style>
    
    <link rel="stylesheet" href="styles.css?v=10.0&t=uniform&human=same">
</head>
<body>
    <div class="game-container">
        <!-- Draw Pile Column -->
        <div class="draw-pile-column">
            <div class="draw-pile-area">
                <div class="draw-pile" id="draw-pile">
                    <div class="card back draw-card"></div>
                    <div class="pile-info">
                        <span id="cards-remaining">94</span> cards
                    </div>
                </div>
                <!-- Card Animation Area -->
                <div class="card-animation-area" id="card-animation-area">
                    <!-- Animated card appears here -->
                </div>
            </div>
        </div>

        <!-- Main Game Area -->
        <div class="game-area">
            <!-- Players Grid -->
            <div class="players-grid" style="position: relative;">
                <!-- Opponent 1 (Left) -->
                <div class="player-area opponent-player opponent-left" id="opponent1">
                    <h3>AI Bot 1</h3>
                    <div class="player-stats">
                        <span class="total-score">Total: <span class="score-value">0</span></span>
                        <span class="round-score">Round: <span class="round-value">0</span></span>
                        <span class="player-status">Waiting</span>
                    </div>
                    <div class="modifier-cards"></div>
                    <div class="number-cards"></div>
                    <div class="unique-counter"><span class="unique-count">○○○○○○○</span></div>
                </div>

                <!-- Opponent 2 (Top) -->
                <div class="player-area opponent-player opponent-top" id="opponent2">
                    <h3>AI Bot 2</h3>
                    <div class="player-stats">
                        <span class="total-score">Total: <span class="score-value">0</span></span>
                        <span class="round-score">Round: <span class="round-value">0</span></span>
                        <span class="player-status">Waiting</span>
                    </div>
                    <div class="modifier-cards"></div>
                    <div class="number-cards"></div>
                    <div class="unique-counter"><span class="unique-count">○○○○○○○</span></div>
                </div>

                <!-- Opponent 3 (Right) -->
                <div class="player-area opponent-player opponent-right" id="opponent3">
                    <h3>AI Bot 3</h3>
                    <div class="player-stats">
                        <span class="total-score">Total: <span class="score-value">0</span></span>
                        <span class="round-score">Round: <span class="round-value">0</span></span>
                        <span class="player-status">Waiting</span>
                    </div>
                    <div class="modifier-cards"></div>
                    <div class="number-cards"></div>
                    <div class="unique-counter"><span class="unique-count">○○○○○○○</span></div>
                </div>

                <!-- Human Player (Bottom) -->
                <div class="player-area main-player" id="player">
                    <h3>You</h3>
                    <div class="player-stats">
                        <span class="total-score">Total: <span class="score-value">0</span></span>
                        <span class="round-score">Round: <span class="round-value">0</span></span>
                        <span class="player-status">Waiting</span>
                    </div>
                    <div class="modifier-cards" id="player-modifiers"></div>
                    <div class="number-cards" id="player-numbers"></div>
                    <div class="unique-counter">
                        <span class="unique-count" id="player-unique">○○○○○○○</span>
                        <span class="flip7-bonus" id="flip7-indicator" style="display: none;">🎉 Flip 7!</span>
                    </div>
                    <div class="action-buttons">
                        <button id="hit-btn" class="btn primary" disabled>Hit</button>
                        <button id="stay-btn" class="btn secondary" disabled>Stay</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Controls Panel -->
        <div class="controls-panel">
            <div class="logo-header">
                <img src="images/FLIP7_LOGO_LOCK_UP_transparent.png" alt="Flip 7" class="flip7-logo">
            </div>

            <div class="control-section">
                <button id="rules-btn" class="btn secondary" style="width: 100%;">Rules</button>
            </div>
            
            <div class="control-section" id="pre-game-controls">
                <button id="new-game-btn" class="btn primary" style="width: 100%; margin-bottom: 10px;">Start Game</button>
                <div class="game-settings">
                    <label>
                        Points to win: 
                        <input type="number" id="win-points" value="200" min="50" max="500" step="50">
                    </label>
                </div>
            </div>

            <!-- Desktop Game Log and Scoreboard -->
            <div class="desktop-info game-log">
                <h4>Game Log</h4>
                <div id="log-content"></div>
            </div>

            <div class="desktop-info scoreboard">
                <h4>Scoreboard</h4>
                <div id="scoreboard-content"></div>
            </div>
        </div>

        <!-- Mobile Status Banner -->
        <div class="mobile-status-banner" id="mobile-status-banner">
            <div class="turn-indicator" id="mobile-turn-indicator"></div>
            <div class="game-info" id="mobile-game-info"></div>
        </div>

        <!-- Mobile Game Board (hidden on desktop, shown on mobile) -->
        <div class="mobile-game-board">
            <!-- Top Controls Section (Logo + Draw Pile + Rules) -->
            <div class="mobile-controls-section">
                <!-- Logo -->
                <img src="images/FLIP7_LOGO_LOCK_UP_transparent.png" alt="Flip 7" class="mobile-logo">
                
                <!-- Draw Pile -->
                <div class="mobile-draw-pile-area">
                    <div class="draw-pile" id="mobile-draw-pile">
                        <div class="card back draw-card"></div>
                        <div class="pile-info">
                            <span id="mobile-cards-remaining">94</span> cards
                        </div>
                    </div>
                    <!-- Card Animation Area for mobile -->
                    <div class="card-animation-area" id="mobile-card-animation-area">
                        <!-- Animated card appears here -->
                    </div>
                </div>
                
                <!-- Rules Button -->
                <button class="mobile-rules-btn" id="mobile-rules-btn">Rules</button>
            </div>

            <!-- Players Container (Flexible Middle Section) -->
            <div class="mobile-players-container">
                <!-- Human Player (Top) -->
                <div id="mobile-player">
                    <!-- Will be populated by JavaScript -->
                </div>

                <!-- Bot Players (Middle) -->
                <div id="mobile-opponent1">
                    <!-- Will be populated by JavaScript -->
                </div>
                <div id="mobile-opponent2">
                    <!-- Will be populated by JavaScript -->
                </div>
                <div id="mobile-opponent3">
                    <!-- Will be populated by JavaScript -->
                </div>
            </div>

            <!-- Bottom Section (Hit/Stay Buttons) -->
            <div class="mobile-bottom-section">
                <button id="mobile-hit-btn" class="btn primary mobile-action-btn">Hit</button>
                <button id="mobile-stay-btn" class="btn secondary mobile-action-btn">Stay</button>
            </div>

        </div>

        <!-- Mobile Info Panel (hidden on desktop) -->
        <div class="mobile-info-panel">
            <div class="game-log">
                <h4>Game Log</h4>
                <div id="log-content"></div>
            </div>

            <div class="scoreboard">
                <h4>Scoreboard</h4>
                <div id="scoreboard-content"></div>
            </div>
        </div>
    </div>

    <!-- Game Message -->
    <button class="game-message desktop-start-btn" id="game-message">
        Start Game
    </button>
    
    <!-- Mobile Name Input Popup -->
    <div class="mobile-name-popup" id="mobile-name-popup">
        <div class="name-popup-content">
            <h2>Enter Player Name:</h2>
            <form id="name-input-form">
                <input type="text" id="player-name-input" placeholder="Your nickname" maxlength="20" required>
                <button type="submit" class="name-submit-btn">Start Game</button>
            </form>
        </div>
    </div>

    <!-- Action Card Prompt -->
    <div class="action-card-prompt" id="action-prompt" style="display: none;">
        <h3 id="action-title">Action Card</h3>
        <p id="action-description"></p>
        <div id="action-buttons"></div>
    </div>

    <!-- Flip 7 Celebration -->
    <div class="flip7-celebration" id="flip7-celebration" style="display: none;">
        <div class="pinata-container" id="pinata-container">
            <div class="pinata" id="pinata">🪅</div>
        </div>
        <div class="glitter-explosion" id="glitter-explosion"></div>
    </div>

    <!-- Winning Celebration -->
    <div id="winning-celebration" class="winning-celebration" style="display: none;">
        <div class="celebration-banner">
            <h1 class="celebration-text">🎉 Congratulations You Won! 🎉</h1>
            <p class="celebration-subtext">Amazing job! Click "Start Game" to play again.</p>
        </div>
        <div class="confetti-container" id="confetti-container"></div>
    </div>

    <!-- Rules Modal -->
    <div id="rules-modal" class="modal" style="display: none;">
        <div class="modal-content">
            <span class="close" id="close-rules">&times;</span>
            <h2>Flip 7 Rules</h2>
            <div class="rules-text">
                <h3>Objective</h3>
                <p>Score points by collecting Number cards (0-12) without duplicates. Get exactly 7 unique Number cards for a 15-point bonus!</p>
                
                <h3>How to Play</h3>
                <ol>
                    <li>Each player receives one card to start</li>
                    <li>On your turn: Hit (draw a card) or Stay (keep your points)</li>
                    <li>If you draw a duplicate number, you BUST and score 0 (unless you have Second Chance)</li>
                    <li>Round ends when all players stay/bust OR someone gets 7 unique numbers</li>
                </ol>
                
                <h3>Card Types</h3>
                <ul>
                    <li><strong>Number Cards (0-12):</strong> Worth their face value</li>
                    <li><strong>Freeze:</strong> Forces you to stay immediately</li>
                    <li><strong>Flip Three:</strong> You must draw 3 cards in a row</li>
                    <li><strong>Second Chance:</strong> Protects from one bust</li>
                    <li><strong>+2, +4, +6, +8, +10:</strong> Bonus points</li>
                    <li><strong>x2:</strong> Doubles your number card total</li>
                </ul>
                
                <h3>Scoring</h3>
                <p>1. Sum all number cards<br>
                2. Apply x2 multiplier (if you have it)<br>
                3. Add modifier bonuses (+2, +4, +6, +8, +10)<br>
                4. Add 15 bonus if you got exactly 7 unique numbers</p>
            </div>
        </div>
    </div>

    <!-- FINAL MOBILE UNIFORM SIZING - AFTER ALL EXTERNAL STYLESHEETS -->
    <style>
    /* HUMAN PLAYER CONTAINER - NATURAL HEIGHT */
    html body .game-container .game-area .players-grid .main-player,
    html body .game-container .game-area .players-grid .player-area.main-player,
    html body .game-container .game-area .players-grid #player,
    html body .game-container .game-area .players-grid div.player-area.main-player,
    html body .game-container .game-area .players-grid div#player.main-player,
    html body .game-container .game-area .players-grid div.main-player,
    .main-player,
    #player {
        flex: 1 !important;
        min-height: auto !important; /* Natural sizing */
        max-height: none !important; /* No height limit */
        height: auto !important; /* Natural height */
        padding: 6px !important;
        margin: 4px 0 !important;
        box-sizing: border-box !important;
        overflow: visible !important; /* Don't clip content */
        background: linear-gradient(135deg, #22577a 0%, #38a3a5 50%, #57cc99 100%) !important;
        border: 2px solid rgba(255,255,255,0.3) !important;
        border-radius: 8px !important;
    }
    
    /* BOT PLAYERS - NATURAL HEIGHT */
    html body .game-container .game-area .players-grid .opponent-player,
    html body .game-container .game-area .players-grid .player-area.opponent-player,
    html body .game-container .game-area .players-grid div.opponent-player,
    .opponent-player {
        flex: 1 !important;
        min-height: auto !important; /* Natural sizing */
        max-height: none !important; /* No height limit */
        height: auto !important; /* Natural height */
        padding: 6px !important;
        margin: 4px 0 !important;
        box-sizing: border-box !important;
        overflow: visible !important; /* Don't clip content */
        background: linear-gradient(135deg, rgba(44, 62, 80, 0.85) 0%, rgba(74, 95, 122, 0.75) 100%) !important;
        border: 2px solid rgba(255,255,255,0.3) !important;
        border-radius: 8px !important;
    }
    </style>

    <script src="game.js?v=3.0&t=20250807"></script>
</body>
</html>